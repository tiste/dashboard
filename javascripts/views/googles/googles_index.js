(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,o=function(e,o){function s(){this.constructor=e}for(var r in o)t.call(o,r)&&(e[r]=o[r]);return s.prototype=o.prototype,e.prototype=new s,e.__super__=o.prototype,e};App.Views.GooglesIndex=function(t){function s(){return this.render=e(this.render,this),this.isSearching=e(this.isSearching,this),this.openSearch=e(this.openSearch,this),this.closeSearch=e(this.closeSearch,this),this.addOne=e(this.addOne,this),this.addAll=e(this.addAll,this),s.__super__.constructor.apply(this,arguments)}return o(s,t),s.prototype.template=JST["templates/googles/index"],s.prototype.events={"click .m-overlay--google":"closeSearch","keyup .m-google--input":function(e){return this.isSearching(e),this.search(e)},"submit .m-google":"doSearch"},s.prototype.initialize=function(){return this.collection.on("reset",this.render,this),_.bindAll(this,"search"),$(document).bind("keydown",this.openSearch)},s.prototype.addAll=function(){return this.collection.each(this.addOne)},s.prototype.addOne=function(e){var t;return t=new App.Views.Google({model:e}),this.$(".m-google--search").append(t.render().el)},s.prototype.closeSearch=function(e){return e&&$(e.target).hasClass("m-overlay--google")?this.$(".m-overlay--google").hide():e?void 0:this.$(".m-overlay--google").hide()},s.prototype.openSearch=function(e){return isChar(e)&&"input"!==e.target.tagName.toLowerCase()?(this.$(".m-overlay--google").show(),this.$(".m-google--input").focus()):void 0},s.prototype.doSearch=function(e){return e.preventDefault(),this.$(".selected").click()},s.prototype.isSearching=function(e){var t,o;return!isChar(e)&&""===this.$(".m-google--input").val()||27===e.keyCode?this.closeSearch():(this.$(".m-overlay--google").show(),o=this.$(".m-google--search--item.selected"),o.length>0?(40===e.keyCode?o.next(".m-google--search--item").length>0&&o.removeClass("selected").next(".m-google--search--item").addClass("selected"):38===e.keyCode&&o.prev(".m-google--search--item").length>0&&o.removeClass("selected").prev(".m-google--search--item").addClass("selected"),t=this.$(".m-google--search--item.selected").position().top+this.$(".m-google--search").scrollTop(),this.$(".m-google--search").stop().animate({scrollTop:t},100)):void 0)},s.prototype.search=_.debounce(function(e){var t;return(e.keyCode<37||e.keyCode>40)&&13!==e.keyCode&&27!==e.keyCode?(t=new App.Collections.Googles,t.fetch({data:{hl:window.App.Settings.get("lang"),q:this.$(".m-google--input").val(),rsz:8},dataType:"jsonp",success:function(e){return function(){return e.collection=t,e.$(".m-google--search").html(""),e.addAll(),$(e.el).find(".selected").length>0?void 0:e.$(".m-google--search--item").first().addClass("selected")}}(this)})):void 0},700),s.prototype.render=function(){return $(this.el).html(this.template),this.addAll(),this},s}(Backbone.View)}).call(this);